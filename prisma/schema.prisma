// prisma/schema.prisma

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  // url ã¯ prisma.config.ts ã§ç®¡ç†ã—ã¦ã„ã‚‹ã®ã§ä¸è¦
}

model Monster {
  id          String   @id @default(uuid())
  name        String
  description String
  imageUrl    String
  
  // ğŸ‘‡ ã“ã“ã‚’å¤‰æ›´ï¼Enumã¯å¾Œã§è¿½åŠ ã§ãã‚‹ã®ã§ã€ã¾ãšã¯Stringã§ç¢ºå®Ÿã«å‹•ã‹ã™
  // type        MonsterType? 
  type        String?      

  hp          Int?
  isAiGenerated Boolean @default(false)
  aiPrompt      String?

  // ğŸ‘‡ ã€é‡è¦ã€‘Userã¨ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤ã—ã€ãŸã ã®ID(æ–‡å­—åˆ—)ã«ã™ã‚‹
  userId      String   
  // user       User     @relation(...) ğŸ‘ˆ å‰Šé™¤ï¼

  likes       Like[]
  comments    Comment[]
  collectedBy Collection[]
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Like {
  id        String   @id @default(uuid()) // è¤‡åˆIDãŒé›£ã—ã„å ´åˆç”¨ã«è¿½åŠ 
  userId    String   // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã—
  monsterId String
  
  // user User ... ğŸ‘ˆ å‰Šé™¤
  monster   Monster  @relation(fields: [monsterId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now())
  
  @@unique([userId, monsterId]) // åŒã˜äººãŒ2å›ã„ã„ã­ã§ããªã„ã‚ˆã†ã«ã™ã‚‹
}

model Comment {
  id        String   @id @default(uuid())
  content   String
  userId    String   // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã—
  monsterId String

  // user User ... ğŸ‘ˆ å‰Šé™¤
  monster   Monster  @relation(fields: [monsterId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now())
}

model Collection {
  id        String   @id @default(uuid())
  userId    String   // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã—
  monsterId String
  
  // user User ... ğŸ‘ˆ å‰Šé™¤
  monster   Monster  @relation(fields: [monsterId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now())
  
  @@unique([userId, monsterId])
}